(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8f653f80"],{2078:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"page"},[a("div",{staticClass:"header"},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{staticStyle:{"margin-right":"15px"},attrs:{placeholder:"请输入企业名称","prefix-icon":"el-icon-search",size:"small",clearable:!0},model:{value:e.search,callback:function(t){e.search="string"===typeof t?t.trim():t},expression:"search"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.searchList}},[e._v("查询")])],1),a("div",[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.openDialog(null)}}},[e._v("新增")])],1)]),a("div",{staticClass:"table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","white-space":"nowrap"},attrs:{data:e.list,border:"",size:"mini"}},[a("el-table-column",{attrs:{fixed:"","show-overflow-tooltip":"",align:"center",prop:"name",label:"企业名称","min-width":"180"}}),a("el-table-column",{attrs:{align:"center",prop:"code",label:"企业编码",width:"140"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"area",label:"所属区域","min-width":"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"address",label:"地址","min-width":"180"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center",prop:"pos",label:"经度/纬度",readonly:!0,"min-width":"180"}}),a("el-table-column",{attrs:{align:"center",prop:"contact",label:"企业负责人",width:"120"}}),a("el-table-column",{attrs:{align:"center",prop:"contactMobile",label:"企业负责人电话",width:"120"}}),a("el-table-column",{attrs:{align:"center",prop:"envContact",label:"环境负责人",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:"环境负责人电话",prop:"envContactMobile",width:"120"}}),a("el-table-column",{attrs:{align:"center",prop:"creatorName",label:"创建人",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createTime","min-width":"150"}}),a("el-table-column",{attrs:{align:"center",prop:"modifierName",label:"修改人",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:"修改时间",prop:"modifyTime","min-width":"150"}}),e.allowEdit?a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.openDialog(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.confirmDelete(t.row.id)}}},[e._v("删除")])]}}],null,!1,523179699)}):e._e()],1)],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","current-page":e.currentPage,pageSize:e.pageSize,total:e.totalNum},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.changePage}})],1),a("el-dialog",{attrs:{title:e.title,visible:e.editFlag,"show-close":!1,"close-on-click-modal":!1,width:"40%"},on:{"update:visible":function(t){e.editFlag=t}}},[a("el-form",{ref:"editForm",attrs:{inline:!0,model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属区域",prop:"areaId"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"small",placeholder:"请选择",disabled:!e.allowEdit},model:{value:e.form.areaId,callback:function(t){e.$set(e.form,"areaId",t)},expression:"form.areaId"}},e._l(e.areas,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),a("el-form-item",{attrs:{label:"企业名称",prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"===typeof t?t.trim():t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"企业地址",prop:"address"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address","string"===typeof t?t.trim():t)},expression:"form.address"}})],1),a("el-form-item",{attrs:{label:"经纬度",prop:"pos"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},model:{value:e.form.pos,callback:function(t){e.$set(e.form,"pos","string"===typeof t?t.trim():t)},expression:"form.pos"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-location-outline"},slot:"append"})],1)],1),a("el-form-item",{attrs:{label:"企业负责人",prop:"contact"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.contact,callback:function(t){e.$set(e.form,"contact","string"===typeof t?t.trim():t)},expression:"form.contact"}})],1),a("el-form-item",{attrs:{label:"企业负责人电话",prop:"contactMobile"}},[a("el-input",{attrs:{size:"small",maxLength:"11",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.form.contactMobile,callback:function(t){e.$set(e.form,"contactMobile","string"===typeof t?t.trim():t)},expression:"form.contactMobile"}})],1),a("el-form-item",{attrs:{label:"环保负责人",prop:"envContact"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.envContact,callback:function(t){e.$set(e.form,"envContact",t)},expression:"form.envContact"}})],1),a("el-form-item",{attrs:{label:"环保负责人电话",prop:"envContactMobile"}},[a("el-input",{attrs:{size:"small"},model:{value:e.form.envContactMobile,callback:function(t){e.$set(e.form,"envContactMobile",t)},expression:"form.envContactMobile"}})],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",disabled:!e.saveAble},on:{click:function(t){e.editFlag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{size:"small",type:"primary",disabled:!e.saveAble},on:{click:function(t){return e.submitForm("editForm")}}},[e._v("保 存")])],1)],1)],1)])},l=[],r=(a("386d"),a("ac6a"),a("7f7f"),a("28e6")),n=a("b328"),i=a("bea6"),s=a("491d"),c={components:{ElInput:s["a"],ElFormItem:i["a"],ElForm:n["a"]},data:function(){return{loading:!1,search:"",list:[],totalNum:0,pageSize:10,currentPage:1,areas:[],form:{id:"",areaId:"",name:"",address:"",longitude:0,latitude:0,pos:"",contact:"",contactMobile:"",envContact:"",envContactMobile:""},title:"新增企业",editFlag:!1,allowEdit:!1,rules:{areaId:[{required:!0,message:"所属区域不能为空",trigger:"blur"}],name:[{required:!0,message:"企业名称不能为空",trigger:"blur"}],address:[{required:!0,message:"企业地址不能为空",trigger:"blur"}],contact:[{required:!0,message:"企业负责人不能为空",trigger:"blur"}]},saveAble:!0}},created:function(){},mounted:function(){this.initData()},methods:{initData:function(){var e=this;Object(r["e"])().then(function(t){2e3===t.code&&(e.areas=t.result)});var t=localStorage.getItem("user.level");e.allowEdit="1"===t||"2"===t;var a={pageNum:1};e.getList(a)},resetForm:function(){this.form.id="",this.form.areaId=parseInt(localStorage.getItem("user.areaId")),this.form.name="",this.form.address="",this.form.longitude=0,this.form.latitude=0,this.form.pos="",this.form.contact="",this.form.contactMobile="",this.form.envContact="",this.form.envContactMobile=""},openDialog:function(e){this.resetForm(),this.$refs["editForm"]&&this.$refs["editForm"].resetFields(),e&&(this.title="修改企业信息",this.form.id=e.id,this.form.areaId=e.areaId,this.form.name=e.name,this.form.address=e.address,this.form.longitude=e.longitude,this.form.latitude=e.latitude,this.form.pos=e.pos,this.form.contact=e.contact,this.form.contactMobile=e.contactMobile,this.form.envContact=e.envContact,this.form.envContactMobile=e.envContactMobile),this.editFlag=!0},getList:function(e){var t=this;e.pageSize=t.pageSize,e.areaId=parseInt(localStorage.getItem("user.areaId")),t.loading=!0,Object(r["i"])(e).then(function(a){2e3===a.code&&(t.currentPage=e.pageNum,t.totalNum=a.result.totalElements,a.result.content.forEach(function(e,a,o){t.areas.forEach(function(t,a,o){t.id===e.areaId&&(e.area=t.name)}),e.pos=e.longitude+" / "+e.latitude}),t.list=a.result.content),t.loading=!1})},changePage:function(e){var t=this,a={pageNum:e};""!==t.search&&(a.enterprise=t.search),"全部"!==t.status&&(a.status=t.status),t.getList(a)},searchList:function(){var e=this;if(e.search.length>10)e.$message.warning("搜索内容请勿太长!");else{var t={pageNum:1};""!==e.search&&(t.name=e.search),e.getList(t)}},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.saveAble=!1,t.form.id?Object(r["o"])(t.form).then(function(e){t.saveAble=!0,2e3===e.code&&(t.$message.success("修改成功"),t.editFlag=!1,t.searchList())}):Object(r["c"])(t.form).then(function(e){t.saveAble=!0,2e3===e.code?(t.$message.success("保存成功"),t.editFlag=!1,t.searchList()):t.$message.error(e.message)})})},confirmDelete:function(e){var t=this;this.$confirm("确定要删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"border-gray",type:"success"}).then(function(){Object(r["g"])({id:e}).then(function(e){2e3===e.code&&(t.$message.success("删除成功"),t.searchList())})}).catch(function(){console.log("取消")})}}},m=c,u=(a("abb8"),a("800e"),a("2877")),d=Object(u["a"])(m,o,l,!1,null,"10b7ccc4",null);t["default"]=d.exports},"7f7f":function(e,t,a){var o=a("86cc").f,l=Function.prototype,r=/^\s*function ([^ (]*)/,n="name";n in l||a("9e1e")&&o(l,n,{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(e){return""}}})},"800e":function(e,t,a){"use strict";var o=a("e6e2"),l=a.n(o);l.a},abb8:function(e,t,a){"use strict";var o=a("d1d3"),l=a.n(o);l.a},d1d3:function(e,t,a){},e6e2:function(e,t,a){}}]);
//# sourceMappingURL=chunk-8f653f80.04bd71f3.js.map